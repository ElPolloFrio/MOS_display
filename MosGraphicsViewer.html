<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>MOS Graphics Viewer</title>
	
	<!-- internet -->
	<!-- 
	<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />
	<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
	<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script> 
	-->

	<!-- local -->
	<link rel="stylesheet" href="jquery-ui-1.10.3.custom/css/smoothness/jquery-ui-1.10.3.custom.css" />
	<script src="jquery-ui-1.10.3.custom/js/jquery-1.9.1.js"></script>
	<script src="jquery-ui-1.10.3.custom/js/jquery-ui-1.10.3.custom.min.js"></script>
	
	<script>		
		$(function() {
			$('#radiomos').buttonset();
			$('#radioelement').buttonset();
		});
		
		// initially hide all images
		$(function() {
			$('.imageset').hide();
			// Run updateImages so that the first images will show up as soon as a site is selected,
			// otherwise the user has to click on MOS and wxelement buttons to get the first 
			//images to show up.
			updateImages();
		});
		
		function updateImages() {
			// Figure out which buttons are checked and store their values to an array. Recall that the 
			// values for each input checkbox were defined to consist of the parts of the div ID for the
			// appropriate imageset.
			var arrDisp = [];
			$("input[type='radio']:checked").each(function(index) {
				arrDisp[index] = ($(this).val());
			});
			strDivID = arrDisp[0] + '-' + arrDisp[1];
			// hide the other images
			$('.imageset').hide();
			// show the appropriate image
			var key = '.imageset#' + strDivID;
			//$(key).show();
			$(key).fadeIn(50);
		};
		
		// click on buttons to change the displayed images
		$(function() {
			$("input[type='radio']").change(function() {
				updateImages();
			});
		});
		
		$(function() {
			$('#menu').menu({
				select: function(event, ui) {
					event.preventDefault();
					$('.ui-state-error', this).removeClass('ui-state-error');
					ui.item.addClass('ui-state-error');
					var siteID = ui.item.text();
					loadImagesBySiteID(siteID);
				}
			});
			
			// Clicking on the main <li> entries in the menu causes every child <li> entry to be selected,
			// including highlighting and running all entries together as a single string for the h1#sid 
			// element. Do something to prevent this.
			$('#menu a.CWA').on('click', function(event, ui) {
				event.stopImmediatePropagation();
			});
			
		});

		function loadImagesBySiteID(siteID) {
			$('h1#sid').text(siteID);
			mostypes = new Array('GFSX', 'GFS', 'NAM');
			elements = new Array('MaxT', 'MinT', 'PoP12');
			for (m in mostypes) {
				for (el in elements) {
					fname = generateImgFilename(siteID, mostypes[m], elements[el]);
					var key = 'img#' + mostypes[m] + '_' + elements[el];
					$(key).attr({src: fname, alt: ''});
				} //element loop
			} //mos loop
		};

		function generateImgFilename(siteID, mos, element) {
			// siteID: e.g., KSTL, TIST, etc.
			// mos: e.g., GFSX, GFS, NAM
			// element: MaxT, MinT, PoP12
			// Input arguments are the components of the filenames generated by Python scripts elsewhere
			var imgpath = 'images/' + siteID + '_' + mos + '_' + element + '.png';
			return imgpath
		};
		
		$(function() {
			// Autocomplete requires a Javascript array, but the list of sites is most easily 
			// generated by using jQuery to select those items. Note that $('#menu li a').text() fails
			// because .text() returns the combined contents of all matched items (i.e., one big string).
			var availableSites = new Array()
			$('#menu li a:not(.CWA)').each(function(index) {
				availableSites[index] = $(this).text();
				});
			$('#sites').autocomplete({
				// increase this if typing 1 character returns thousands of results
				minLength: 1,
				source: availableSites,
				select: function(event, ui) {
					// When an item is selected from the autocomplete menu, update
					// the tabs as if the item had been selected from the main menu.
					$('#menu li a:not(.CWA):contains(' + ui.item.value + ')').trigger('click');
					// clear the autocomplete field
					$(this).val('');
					return false; //needed to clear the field
				},
				close: function(event, ui) {
					// Clear the input value if nothing was selected from the autocomplete box.
					// The "close" event fires when the menu closes, which happens if an item is 
					// selected or if the input loses focus.
					if (ui.item === null || !ui.item) {
						$(this).val('');
					}
				}
			});
			
			// When the user starts typing in letters, the desired ASOS may show up very quickly, or they
			// may already know the whole 4-letter ASOS site ID (but not the CWA). Either way, if the user
			// presses enter after entering text, select the first entry in the autocomplete box and update 
			// the tabs as if that site had been selected from the main menu. Note that this won't give the
			// expected result if the user-entered site ID was not found in the autocomplete list. Instead of
			// a helpful message about 'site not available', it will still grab the first closest match from 
			// the autocomplete list. 
			$('#sites').bind('keydown', function(event, ui) {
				var code = event.keyCode || event.which;
				if (code == 13) {
					// enter was pressed
					// get the first entry in the autocomplete list
					var firstfit = $('.ui-autocomplete li:first a').text();
					//trigger a click on the menu item, etc.
					$('#menu li a:not(.CWA):contains(' + firstfit + ')').trigger('click');
				}
			});
		});
		
	</script>
	
	<style>
		/* to avoid cross-browser issues */
		body {
			margin: 5px;
			padding: 5px;
		}
		
		.ui-menu {
			width: 150px; 
			display: inline-block;
			float: left;
			margin: 20px;
			padding: 0;
			z-index: 100;
			/* add scrolling for long submenus */
			max-height: 350px;
			overflow-y: auto;
			/* prevent horiz scroll */
			overflow-x: hidden;
		}
		
		.ui-autocomplete {
			max-height: 200px;
			overflow-y: auto;
			/* prevent horiz scroll */
			overflow-x: hidden;
		}		
		
		#acbox {
			clear: both;
		}
		
		#displayarea {
			width: 850px;
			display: inline-block;
			margin: 5px;
			padding: 0;
		}
		
		h1#sid {
			text-align: center;
			font-family: sans-serif;
		}
		
		div#container4controls {
			margin-left: auto;
			margin-right: auto;
			width: 40%;
		}
		
		#radiomos {
			display: inline;
			float: left;
			margin: 10px;
		}
		
		#radioelement {
			display: inline;
			float: left;
			margin: 10px;
		}
		
	</style>
</head>

<body>
	<!-- big site ID at the top of the page -->
	<h1 id="sid">Choose a site</h1>
	
	<!-- buttons to select MOS type and weather element -->
	<!-- define the value to be equal to the portion of the div id for the imageset -->
	<div id="container4controls">
		<form>
			<div id="radiomos">
				<input type="radio" id="radio-GFSX" name="radio" value='GFSX' checked="checked" /><label for="radio-GFSX">MEX</label>
				<input type="radio" id="radio-GFS" name="radio" value='GFS' /><label for="radio-GFS">MAV</label>
				<input type="radio" id="radio-NAM" name="radio" value='NAM' /><label for="radio-NAM">MET</label>
			</div>
		</form>
		<form>
			<div id="radioelement">
				<input type="radio" id="radio-XN" name="radio" value='XN' /><label for="radio-XN">X/N</label>
				<input type="radio" id="radio-P12" name="radio" value='P12' checked="checked" /><label for="radio-P12">P12</label>
			</div>
		</form>
	</div>

	<!-- autocomplete box to select sites-->
	<div class="ui-widget" id="acbox">
		<label for="sites">Sites: </label>
		<input id="sites" />
	</div>

	<!-- CWA menu to select sites-->
	<ul id="menu">
		<li><a class="CWA" href="#">LSX</a>
			<ul>
				<li><a href="#">K3LF</a></li>
				<li><a href="#">KALN</a></li>
				<li><a href="#">KBLV</a></li>
				<li><a href="#">KCOU</a></li>
				<li><a href="#">KCPS</a></li>
				<li><a href="#">KENL</a></li>
				<li><a href="#">KFAM</a></li>
				<li><a href="#">KJEF</a></li>
				<li><a href="#">KPPQ</a></li>
				<li><a href="#">KSAR</a></li>
				<li><a href="#">KSET</a></li>
				<li><a href="#">KSLO</a></li>
				<li><a href="#">KSTL</a></li>
				<li><a href="#">KSUS</a></li>
				<li><a href="#">KUIN</a></li>
			</ul>
		</li>
		<li><a class="CWA" href="#">Test cases</a>
			<ul>
				<li><a href="#">KGSH</a></li>
				<li><a href="#">KONT</a></li>
				<li><a href="#">KORD</a></li>
				<li><a href="#">KOUN</a></li>
				<li><a href="#">NSTU</a></li>
				<li><a href="#">PABR</a></li>
				<li><a href="#">PAJN</a></li>
				<li><a href="#">PHNL</a></li>
				<li><a href="#">TIST</a></li>
				<li><a href="#">TJMZ</a></li>
			</ul>
		</li>
		<li><a class="CWA" href="#">SGF</a>
			<ul>
				<li><a href="#">KAIZ</a></li>
				<li><a href="#">KJLN</a></li>
				<li><a href="#">KSGF</a></li>
				<li><a href="#">KTBN</a></li>
				<li><a href="#">KUNO</a></li>
				<li><a href="#">KVIH</a></li>
			</ul>
		</li>
		<li><a class="CWA" href="#">EAX</a>
			<ul>
				<li><a href="#">KCDJ</a></li>
				<li class="ui-state-disabled"><a href="#">KDMO</a></li>
				<li><a href="#">KIRK</a></li>
				<li><a href="#">KIXD</a></li>
				<li class="ui-state-disabled"><a href="#">KLXT</a></li>
				<li><a href="#">KMCI</a></li>
				<li class="ui-state-disabled"><a href="#">KMKC</a></li>
				<li class="ui-state-disabled"><a href="#">KOJC</a></li>
				<li><a href="#">KSTJ</a></li>
				<li><a href="#">KSZL</a></li>
			</ul>
		</li>
		<li><a class="CWA" href="#">ILX</a>
			<ul>
				<li><a href="#">K1H2</a></li>
				<li class="ui-state-disabled"><a href="#">KAAA</a></li>
				<li class="ui-state-disabled"><a href="#">KAJG</a></li>
				<li><a href="#">KBMI</a></li>
				<li><a href="#">KCMI</a></li>
				<li class="ui-state-disabled"><a href="#">KDEC</a></li>
				<li class="ui-state-disabled"><a href="#">KDNV</a></li>
				<li><a href="#">KFOA</a></li>
				<li class="ui-state-disabled"><a href="#">KGBG</a></li>
				<li><a href="#">KIJX</a></li>
				<li class="ui-state-disabled"><a href="#">KLWV</a></li>
				<li class="ui-state-disabled"><a href="#">KMTO</a></li>
				<li class="ui-state-disabled"><a href="#">KOLY</a></li>
				<li><a href="#">KPIA</a></li>
				<li class="ui-state-disabled"><a href="#">KPRG</a></li>
				<li class="ui-state-disabled"><a href="#">KRSV</a></li>
				<li><a href="#">KSPI</a></li>
				<li><a href="#">KTAZ</a></li>
				<li class="ui-state-disabled"><a href="#">KTIP</a></li>
			</ul>
		</li>
		<li class="ui-state-disabled"><a class="CWA" href="#">PAH</a>
			<ul>
				<li><a href="#">KCIR</a></li>
				<li><a href="#">KCGI</a></li>
				<li><a href="#">KCUL</a></li>
				<li><a href="#">KEHR</a></li>
				<li><a href="#">KEVV</a></li>
				<li><a href="#">KFWC</a></li>
				<li><a href="#">KHOP</a></li>
				<li><a href="#">KHSB</a></li>
				<li><a href="#">KM30</a></li>
				<li><a href="#">KMDH</a></li>
				<li><a href="#">KMVN</a></li>
				<li><a href="#">KMWA</a></li>
				<li><a href="#">KOWB</a></li>
				<li><a href="#">KPAH</a></li>
				<li><a href="#">KPOF</a></li>
			</ul>
		</li>
		<li class="ui-state-disabled"><a class="CWA" href="#">DVN</a>
			<ul>
				<li><a href="#">KAWG</a></li>
				<li><a href="#">KBRL</a></li>
				<li><a href="#">KC75</a></li>
				<li><a href="#">KCID</a></li>
				<li><a href="#">KCWI</a></li>
				<li><a href="#">KDBQ</a></li>
				<li><a href="#">KDVN</a></li>
				<li><a href="#">KEOK</a></li>
				<li><a href="#">KFEP</a></li>
				<li><a href="#">KFFL</a></li>
				<li><a href="#">KFSW</a></li>
				<li><a href="#">KIIB</a></li>
				<li><a href="#">KIOW</a></li>
				<li><a href="#">KMLI</a></li>
				<li><a href="#">KMPZ</a></li>
				<li><a href="#">KMQB</a></li>
				<li><a href="#">KMUT</a></li>
				<li><a href="#">KMXO</a></li>
				<li><a href="#">KSFY</a></li>
				<li><a href="#">KSQI</a></li>
				<li><a href="#">KVTI</a></li>
			</ul>
		</li>
		<li class="ui-state-disabled"><a class="CWA" href="#">MPX</a>
			<ul>
				<li><a href="#">KACQ</a></li>
				<li><a href="#">KAEL</a></li>
				<li><a href="#">KANE</a></li>
				<li><a href="#">KAQP</a></li>
				<li><a href="#">KAXN</a></li>
				<li><a href="#">KBBB</a></li>
				<li><a href="#">KCBG</a></li>
				<li><a href="#">KCFE</a></li>
				<li><a href="#">KDXX</a></li>
				<li><a href="#">KEAU</a></li>
				<li><a href="#">KFBL</a></li>
				<li><a href="#">KFCM</a></li>
				<li><a href="#">KFRM</a></li>
				<li><a href="#">KFSE</a></li>
				<li><a href="#">KGDB</a></li>
				<li><a href="#">KGHW</a></li>
				<li><a href="#">KGYL</a></li>
				<li><a href="#">KHCD</a></li>
				<li><a href="#">KJMR</a></li>
				<li><a href="#">KJYG</a></li>
				<li><a href="#">KLJF</a></li>
				<li><a href="#">KLUM</a></li>
				<li><a href="#">KLVN</a></li>
				<li><a href="#">KLXL</a></li>
				<li><a href="#">KMGG</a></li>
				<li><a href="#">KMIC</a></li>
				<li><a href="#">KMKT</a></li>
				<li><a href="#">KMOX</a></li>
				<li><a href="#">KMSP</a></li>
				<li><a href="#">KMVE</a></li>
				<li><a href="#">KOEO</a></li>
				<li><a href="#">KOVL</a></li>
				<li><a href="#">KOWA</a></li>
				<li><a href="#">KPNM</a></li>
				<li><a href="#">KRCX</a></li>
				<li><a href="#">KRGK</a></li>
				<li><a href="#">KRNH</a></li>
				<li><a href="#">KROS</a></li>
				<li><a href="#">KRPD</a></li>
				<li><a href="#">KRWF</a></li>
				<li><a href="#">KSGS</a></li>
				<li><a href="#">KSTC</a></li>
				<li><a href="#">KSTP</a></li>
				<li><a href="#">KSYN</a></li>
				<li><a href="#">KULM</a></li>
			</ul>
		</li>
		<li><a class="CWA" href="#">LIX</a>
			<ul>
				<li><a href="#">KASD</a></li>
				<li><a href="#">KBIX</a></li>
				<li><a href="#">KBTR</a></li>
				<li><a href="#">KGPT</a></li>
				<li><a href="#">KHDC</a></li>
				<li><a href="#">KHUM</a></li>
				<li><a href="#">KMCB</a></li>
				<li><a href="#">KMSY</a></li>
				<li><a href="#">KNBG</a></li>
				<li><a href="#">KNEW</a></li>
				<li><a href="#">KPQL</a></li>
			</ul>
		</li>
	</ul>
	
	<!-- display area for graphics -->
	<div id="displayarea">
		<div id="GFSX-XN" class="imageset">
			<img id="GFSX_MaxT" src="" alt="" width="375" height="600">
			<img id="GFSX_MinT" src="" alt="" width="375" height="600">
		</div>
		<div id="GFSX-P12" class="imageset">
			<img id="GFSX_PoP12" src="" alt="" width="800" height="600">
		</div>

		<div id="GFS-XN" class="imageset">
			<img id="GFS_MaxT" src="" alt="" width="375" height="600">
			<img id="GFS_MinT" src="" alt="" width="375" height="600">
		</div>
		<div id="GFS-P12" class="imageset">
			<img id="GFS_PoP12" src="" alt="" width="800" height="600">
		</div>
	
		<div id="NAM-XN" class="imageset">
			<img id="NAM_MaxT" src="" alt="" width="375" height="600">
			<img id="NAM_MinT" src="" alt="" width="375" height="600">
		</div>
		<div id="NAM-P12" class="imageset">
			<img id="NAM_PoP12" src="" alt="" width="800" height="600">
		</div>
	</div>

</body>

</html>